<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMAN25 Badge Firmware: Mutex.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FMAN25 Badge Firmware
   </div>
   <div id="projectbrief">ESP-IDF embedded firmware for interactive badge: BLE, LEDs, touch, audio, storage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_mutex_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Mutex.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>FreeRTOS mutex wrapper for thread synchronization.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;freertos/semphr.h&quot;</code><br />
<code>#include &quot;esp_err.h&quot;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;Mutex.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7b301da6e612116964720790dadc4dc3" id="r_a7b301da6e612116964720790dadc4dc3"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b301da6e612116964720790dadc4dc3">Mutex_Create</a> (SemaphoreHandle_t *pMutex)</td></tr>
<tr class="memdesc:a7b301da6e612116964720790dadc4dc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a FreeRTOS mutex.  <br /></td></tr>
<tr class="memitem:a2f044daf0abee5cc47d47cc34e83c8b3" id="r_a2f044daf0abee5cc47d47cc34e83c8b3"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f044daf0abee5cc47d47cc34e83c8b3">Mutex_Free</a> (SemaphoreHandle_t *pMutex)</td></tr>
<tr class="memdesc:a2f044daf0abee5cc47d47cc34e83c8b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a FreeRTOS mutex.  <br /></td></tr>
<tr class="memitem:af07b6d5c7353b1341f2f741d0c9a5f53" id="r_af07b6d5c7353b1341f2f741d0c9a5f53"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af07b6d5c7353b1341f2f741d0c9a5f53">Mutex_Lock</a> (SemaphoreHandle_t *pMutex, TickType_t xTicksToWait)</td></tr>
<tr class="memdesc:af07b6d5c7353b1341f2f741d0c9a5f53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks a FreeRTOS mutex.  <br /></td></tr>
<tr class="memitem:affaeedbbcb2b0e654e3bbf41f9ea0d72" id="r_affaeedbbcb2b0e654e3bbf41f9ea0d72"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#affaeedbbcb2b0e654e3bbf41f9ea0d72">Mutex_Unlock</a> (SemaphoreHandle_t *pMutex)</td></tr>
<tr class="memdesc:affaeedbbcb2b0e654e3bbf41f9ea0d72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlocks a FreeRTOS mutex.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a85b9c772bbeb480b209a3e6ea92b4c" id="r_a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a85b9c772bbeb480b209a3e6ea92b4c">TAG</a> = &quot;MUT&quot;</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>FreeRTOS mutex wrapper for thread synchronization. </p>
<p>This module provides a simplified wrapper around FreeRTOS mutexes, offering a consistent API for creating, locking, and unlocking binary semaphores for thread-safe access to shared resources.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md99"></a>
Key Features:</h2>
<ul>
<li><b>Thread-safe access</b>: Ensures exclusive access to critical sections</li>
<li><b>Resource protection</b>: Prevents data corruption in multi-threaded environments</li>
<li><b>Timeout support</b>: Configurable wait times for mutex acquisition</li>
<li><b>Error handling</b>: Robust error reporting for mutex operations</li>
<li><b>Simplified API</b>: Abstracts FreeRTOS mutex complexities</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md100"></a>
Implementation Details:</h2>
<ul>
<li>Uses FreeRTOS <span class="tt">xSemaphoreCreateMutex()</span> for mutex creation</li>
<li>Employs <span class="tt">xSemaphoreTake()</span> for locking with optional timeouts</li>
<li>Utilizes <span class="tt">xSemaphoreGive()</span> for unlocking the mutex</li>
<li>Provides <span class="tt">vSemaphoreDelete()</span> for proper resource cleanup</li>
<li>Integrates ESP-IDF logging for operational status and errors</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md101"></a>
Usage Patterns:</h2>
<ul>
<li>Call <span class="tt"><a class="el" href="#a7b301da6e612116964720790dadc4dc3" title="Creates a FreeRTOS mutex.">Mutex_Create()</a></span> once to initialize a mutex before use.</li>
<li>Use <span class="tt"><a class="el" href="#af07b6d5c7353b1341f2f741d0c9a5f53" title="Locks a FreeRTOS mutex.">Mutex_Lock()</a></span> before accessing shared resources.</li>
<li>Call <span class="tt"><a class="el" href="#affaeedbbcb2b0e654e3bbf41f9ea0d72" title="Unlocks a FreeRTOS mutex.">Mutex_Unlock()</a></span> after finishing with shared resources.</li>
<li>Call <span class="tt"><a class="el" href="#a2f044daf0abee5cc47d47cc34e83c8b3" title="Deletes a FreeRTOS mutex.">Mutex_Free()</a></span> to release mutex resources when no longer needed.</li>
<li>Always check return values for error handling.</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Badge Development Team </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024 </dd></dl>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a7b301da6e612116964720790dadc4dc3" name="a7b301da6e612116964720790dadc4dc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b301da6e612116964720790dadc4dc3">&#9670;&#160;</a></span>Mutex_Create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t Mutex_Create </td>
          <td>(</td>
          <td class="paramtype">SemaphoreHandle_t *</td>          <td class="paramname"><span class="paramname"><em>pMutex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a FreeRTOS mutex. </p>
<p>This function attempts to create a FreeRTOS mutex. If the mutex pointer is already non-NULL, it indicates the mutex has already been created, and an error is returned. Otherwise, a new mutex is created.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMutex</td><td>Pointer to a <span class="tt">SemaphoreHandle_t</span> where the created mutex handle will be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><span class="tt">ESP_OK</span> if the mutex was successfully created. </dd>
<dd>
<span class="tt">ESP_FAIL</span> if the mutex could not be created (e.g., out of memory) or if it already exists. </dd></dl>

</div>
</div>
<a id="a2f044daf0abee5cc47d47cc34e83c8b3" name="a2f044daf0abee5cc47d47cc34e83c8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f044daf0abee5cc47d47cc34e83c8b3">&#9670;&#160;</a></span>Mutex_Free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t Mutex_Free </td>
          <td>(</td>
          <td class="paramtype">SemaphoreHandle_t *</td>          <td class="paramname"><span class="paramname"><em>pMutex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a FreeRTOS mutex. </p>
<p>This function attempts to delete an existing FreeRTOS mutex and frees any associated memory. If the mutex pointer is NULL, it indicates the mutex has not been created or has already been freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMutex</td><td>Pointer to a <span class="tt">SemaphoreHandle_t</span> holding the mutex handle to be deleted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><span class="tt">ESP_OK</span> if the mutex was successfully deleted. </dd>
<dd>
<span class="tt">ESP_FAIL</span> if the mutex could not be deleted (e.g., not created). </dd></dl>

</div>
</div>
<a id="af07b6d5c7353b1341f2f741d0c9a5f53" name="af07b6d5c7353b1341f2f741d0c9a5f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07b6d5c7353b1341f2f741d0c9a5f53">&#9670;&#160;</a></span>Mutex_Lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t Mutex_Lock </td>
          <td>(</td>
          <td class="paramtype">SemaphoreHandle_t *</td>          <td class="paramname"><span class="paramname"><em>pMutex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TickType_t</td>          <td class="paramname"><span class="paramname"><em>xTicksToWait</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locks a FreeRTOS mutex. </p>
<p>This function attempts to obtain a lock on the specified mutex. If the mutex is not available, the calling task will block for a maximum of <span class="tt">xTicksToWait</span> FreeRTOS ticks. If <span class="tt">xTicksToWait</span> is 0, the function will return immediately if the mutex is not available.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMutex</td><td>Pointer to a <span class="tt">SemaphoreHandle_t</span> holding the mutex handle to lock. </td></tr>
    <tr><td class="paramname">xTicksToWait</td><td>The maximum number of ticks to wait for the mutex to become available. Use <span class="tt">portMAX_DELAY</span> to wait indefinitely. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><span class="tt">ESP_OK</span> if the mutex was successfully locked. </dd>
<dd>
<span class="tt">ESP_FAIL</span> if the mutex could not be locked within the specified timeout. </dd></dl>

</div>
</div>
<a id="affaeedbbcb2b0e654e3bbf41f9ea0d72" name="affaeedbbcb2b0e654e3bbf41f9ea0d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affaeedbbcb2b0e654e3bbf41f9ea0d72">&#9670;&#160;</a></span>Mutex_Unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t Mutex_Unlock </td>
          <td>(</td>
          <td class="paramtype">SemaphoreHandle_t *</td>          <td class="paramname"><span class="paramname"><em>pMutex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unlocks a FreeRTOS mutex. </p>
<p>This function releases a lock on the specified mutex, making it available for other tasks to acquire. It should only be called by the task that currently holds the mutex.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pMutex</td><td>Pointer to a <span class="tt">SemaphoreHandle_t</span> holding the mutex handle to unlock. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><span class="tt">ESP_OK</span> if the mutex was successfully unlocked. </dd>
<dd>
<span class="tt">ESP_FAIL</span> if the mutex could not be unlocked (e.g., not held by the calling task). </dd></dl>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a5a85b9c772bbeb480b209a3e6ea92b4c" name="a5a85b9c772bbeb480b209a3e6ea92b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a85b9c772bbeb480b209a3e6ea92b4c">&#9670;&#160;</a></span>TAG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* TAG = &quot;MUT&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="_mutex_8c.html">Mutex.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
