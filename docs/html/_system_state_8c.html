<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMAN25 Badge Firmware: SystemState.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FMAN25 Badge Firmware
   </div>
   <div id="projectbrief">ESP-IDF embedded firmware for interactive badge: BLE, LEDs, touch, audio, storage</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_system_state_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">SystemState.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Central system state management implementation for the Badge.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/timers.h&quot;</code><br />
<code>#include &quot;esp_check.h&quot;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;esp_random.h&quot;</code><br />
<code>#include &quot;esp_system.h&quot;</code><br />
<code>#include &quot;mbedtls/base64.h&quot;</code><br />
<code>#include &quot;BadgeStats.h&quot;</code><br />
<code>#include &quot;BleControl.h&quot;</code><br />
<code>#include &quot;BleControl_Service.h&quot;</code><br />
<code>#include &quot;BleControl_ServiceChar_FileTransfer.h&quot;</code><br />
<code>#include &quot;Console.h&quot;</code><br />
<code>#include &quot;DiskUtilities.h&quot;</code><br />
<code>#include &quot;LedModing.h&quot;</code><br />
<code>#include &quot;LedSequences.h&quot;</code><br />
<code>#include &quot;NotificationDispatcher.h&quot;</code><br />
<code>#include &quot;Ocarina.h&quot;</code><br />
<code>#include &quot;OtaUpdate.h&quot;</code><br />
<code>#include &quot;SynthMode.h&quot;</code><br />
<code>#include &quot;SystemState.h&quot;</code><br />
<code>#include &quot;TaskPriorities.h&quot;</code><br />
<code>#include &quot;TimeUtils.h&quot;</code><br />
<code>#include &quot;TouchSensor.h&quot;</code><br />
<code>#include &quot;TouchActions.h&quot;</code><br />
<code>#include &quot;UserSettings.h&quot;</code><br />
<code>#include &quot;Utilities.h&quot;</code><br />
<code>#include &quot;WifiClient.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a69bf3d5117afe9362acf7c15daeaae9e" id="r_a69bf3d5117afe9362acf7c15daeaae9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69bf3d5117afe9362acf7c15daeaae9e">PEER_RSSID_SONG_THRESHOLD_TRON</a>&#160;&#160;&#160;(-50)</td></tr>
<tr class="memitem:a6d9718f519d6f273d9003f88eabf5ff3" id="r_a6d9718f519d6f273d9003f88eabf5ff3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d9718f519d6f273d9003f88eabf5ff3">PEER_RSSID_SONG_THRESHOLD_REACTOR</a>&#160;&#160;&#160;(-50)</td></tr>
<tr class="memitem:a0d585c6ccad4f1f84505749b0382fc11" id="r_a0d585c6ccad4f1f84505749b0382fc11"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0d585c6ccad4f1f84505749b0382fc11">PEER_RSSID_SONG_THRESHOLD_CREST</a>&#160;&#160;&#160;(-58)</td></tr>
<tr class="memitem:ad562eb51a425b8b0c65343dc5459fa83" id="r_ad562eb51a425b8b0c65343dc5459fa83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad562eb51a425b8b0c65343dc5459fa83">PEER_RSSID_SONG_THRESHOLD_FMAN25</a>&#160;&#160;&#160;(-58)</td></tr>
<tr class="memitem:a83a6230f254c1690d772ddd1b3d1ecd3" id="r_a83a6230f254c1690d772ddd1b3d1ecd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83a6230f254c1690d772ddd1b3d1ecd3">LED_GAME_STATUS_TOGGLE_DURATION_MSEC</a>&#160;&#160;&#160;(5000)</td></tr>
<tr class="memitem:a815f657876b0dfa8ee4485d7d94fb1a7" id="r_a815f657876b0dfa8ee4485d7d94fb1a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a815f657876b0dfa8ee4485d7d94fb1a7">PEER_SONG_COOLDOWN_DURATION_MSEC</a>&#160;&#160;&#160;(3*60*1000)</td></tr>
<tr class="memitem:a9d8e9ba4f6f26528547e10cf12b04757" id="r_a9d8e9ba4f6f26528547e10cf12b04757"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d8e9ba4f6f26528547e10cf12b04757">LED_PREVIEW_DRAW_DURATION_MSEC</a>&#160;&#160;&#160;(2000)</td></tr>
<tr class="memitem:a3ae9983b8b8d110990dac19c6432077b" id="r_a3ae9983b8b8d110990dac19c6432077b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ae9983b8b8d110990dac19c6432077b">STATUS_INDICATOR_DRAW_DURATION_MSEC</a>&#160;&#160;&#160;(3000)</td></tr>
<tr class="memitem:ac9beead3721c95a813057b4cf8b4cfa1" id="r_ac9beead3721c95a813057b4cf8b4cfa1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9beead3721c95a813057b4cf8b4cfa1">NETWORK_TEST_DRAW_DURATION_MSEC</a>&#160;&#160;&#160;(10000)</td></tr>
<tr class="memitem:aca300e35cbd8e1e85bc9a861d5b3abc4" id="r_aca300e35cbd8e1e85bc9a861d5b3abc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca300e35cbd8e1e85bc9a861d5b3abc4">NETWORK_TEST_SUCCESS_DRAW_DURATION_MSEC</a>&#160;&#160;&#160;(2000)</td></tr>
<tr class="memitem:ad7df2e96e10499c689d17b995e333a4b" id="r_ad7df2e96e10499c689d17b995e333a4b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7df2e96e10499c689d17b995e333a4b">TOUCH_ACTIVE_TIMEOUT_DURATION_MSEC</a>&#160;&#160;&#160;(5000)</td></tr>
<tr class="memitem:afb75e0fc85cbf5ae2caff4f92fced919" id="r_afb75e0fc85cbf5ae2caff4f92fced919"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb75e0fc85cbf5ae2caff4f92fced919">BATTERY_SEQUENCE_DRAW_DURATION_MSEC</a>&#160;&#160;&#160;(3000)</td></tr>
<tr class="memitem:a1714a0043a0662cc25b9ad6b6b3a0cb9" id="r_a1714a0043a0662cc25b9ad6b6b3a0cb9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1714a0043a0662cc25b9ad6b6b3a0cb9">BLE_SERVICE_DISABLE_TIMEOUT_AFTER_GAME_INTERRUPTION</a>&#160;&#160;&#160;(10 * 1000 * 1000)</td></tr>
<tr class="memitem:a2d81500c1609f5a48632c05e41012338" id="r_a2d81500c1609f5a48632c05e41012338"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d81500c1609f5a48632c05e41012338">FIRSTBOOT_FILE_NAME</a>&#160;&#160;&#160;MOUNT_PATH &quot;/fb&quot;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab31a5c038c7b0e33a74c95e81ea446cc" id="r_ab31a5c038c7b0e33a74c95e81ea446cc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab31a5c038c7b0e33a74c95e81ea446cc">SystemState_TouchActiveTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:ab31a5c038c7b0e33a74c95e81ea446cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback for touch activity timeout.  <br /></td></tr>
<tr class="memitem:abfedaea5a33eb8d26d6ea8f9bd8a6404" id="r_abfedaea5a33eb8d26d6ea8f9bd8a6404"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfedaea5a33eb8d26d6ea8f9bd8a6404">SystemState_ResetTouchActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:abfedaea5a33eb8d26d6ea8f9bd8a6404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset/arm the touch activity timer.  <br /></td></tr>
<tr class="memitem:a00d3c2470bb1fdb78771896e764843b8" id="r_a00d3c2470bb1fdb78771896e764843b8"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00d3c2470bb1fdb78771896e764843b8">SystemState_TouchInactiveTimerExpired</a> (SystemState *this)</td></tr>
<tr class="memdesc:a00d3c2470bb1fdb78771896e764843b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deactivate touch mode when the touch inactivity timer expires.  <br /></td></tr>
<tr class="memitem:a9285f807d167d4cab0c5caca796b2b7d" id="r_a9285f807d167d4cab0c5caca796b2b7d"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9285f807d167d4cab0c5caca796b2b7d">SystemState_StopTouchActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:a9285f807d167d4cab0c5caca796b2b7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the touch activity timer and transition to inactive state.  <br /></td></tr>
<tr class="memitem:ae06cab80adb3f870e90cc3f751d85928" id="r_ae06cab80adb3f870e90cc3f751d85928"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae06cab80adb3f870e90cc3f751d85928">SystemState_BatteryIndicatorActiveTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:ae06cab80adb3f870e90cc3f751d85928"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback for battery indicator active window expiry.  <br /></td></tr>
<tr class="memitem:a577a928c99dd0537ef3adeeee8f93702" id="r_a577a928c99dd0537ef3adeeee8f93702"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a577a928c99dd0537ef3adeeee8f93702">SystemState_ResetBatteryIndicatorActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:a577a928c99dd0537ef3adeeee8f93702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arm/reset the battery indicator active timer.  <br /></td></tr>
<tr class="memitem:a2bd564264ee656fea9d997c1dc1bb2ef" id="r_a2bd564264ee656fea9d997c1dc1bb2ef"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2bd564264ee656fea9d997c1dc1bb2ef">SystemState_BatteryIndicatorInactiveTimerExpired</a> (SystemState *this)</td></tr>
<tr class="memdesc:a2bd564264ee656fea9d997c1dc1bb2ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off the battery indicator when its active window expires.  <br /></td></tr>
<tr class="memitem:afbed9dd56bb381a1dca666e4503d0880" id="r_afbed9dd56bb381a1dca666e4503d0880"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbed9dd56bb381a1dca666e4503d0880">SystemState_ResetPeerSongCooldownTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:afbed9dd56bb381a1dca666e4503d0880"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the cooldown timer that gates peer song replays.  <br /></td></tr>
<tr class="memitem:a5d5118df61ee04a31af3cfb07fe74d32" id="r_a5d5118df61ee04a31af3cfb07fe74d32"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d5118df61ee04a31af3cfb07fe74d32">SystemState_NetworkTestActiveTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:a5d5118df61ee04a31af3cfb07fe74d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback for network test active window expiry.  <br /></td></tr>
<tr class="memitem:a6f69ef3e19b1c56056c0d0d0c2477211" id="r_a6f69ef3e19b1c56056c0d0d0c2477211"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f69ef3e19b1c56056c0d0d0c2477211">SystemState_ResetNetworkTestActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:a6f69ef3e19b1c56056c0d0d0c2477211"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arm/reset the network test active timer and set active flag.  <br /></td></tr>
<tr class="memitem:a559a16a968af7d423b8a52d1f55e632e" id="r_a559a16a968af7d423b8a52d1f55e632e"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a559a16a968af7d423b8a52d1f55e632e">SystemState_StopNetworkTestActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:a559a16a968af7d423b8a52d1f55e632e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the network test active timer.  <br /></td></tr>
<tr class="memitem:a5283ee515f6c93e4fc358a5370b7d491" id="r_a5283ee515f6c93e4fc358a5370b7d491"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5283ee515f6c93e4fc358a5370b7d491">SystemState_NetworkTestInactiveTimerExpired</a> (SystemState *this)</td></tr>
<tr class="memdesc:a5283ee515f6c93e4fc358a5370b7d491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer expiry callback body for network test activity window.  <br /></td></tr>
<tr class="memitem:a03c8feae48b305bfaeac538c8231b7d2" id="r_a03c8feae48b305bfaeac538c8231b7d2"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03c8feae48b305bfaeac538c8231b7d2">SystemState_LedSequencePreviewInactiveTimerExpired</a> (SystemState *this)</td></tr>
<tr class="memdesc:a03c8feae48b305bfaeac538c8231b7d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the LED sequence preview when its timer expires.  <br /></td></tr>
<tr class="memitem:ac9a8d9f0757ff17e015bdc321daa9552" id="r_ac9a8d9f0757ff17e015bdc321daa9552"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9a8d9f0757ff17e015bdc321daa9552">SystemState_LedSequencePreviewActiveTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:ac9a8d9f0757ff17e015bdc321daa9552"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback for LED sequence preview expiry.  <br /></td></tr>
<tr class="memitem:adf227eb58095d9e7db0d0558a56bcb56" id="r_adf227eb58095d9e7db0d0558a56bcb56"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf227eb58095d9e7db0d0558a56bcb56">SystemState_ResetLedSequencePreviewActiveTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:adf227eb58095d9e7db0d0558a56bcb56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arm/reset the LED sequence preview timer.  <br /></td></tr>
<tr class="memitem:a7ac046843eec05f06a1319ad775b1d52" id="r_a7ac046843eec05f06a1319ad775b1d52"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ac046843eec05f06a1319ad775b1d52">SystemState_LedGameStatusToggleTimerExpired</a> (SystemState *this)</td></tr>
<tr class="memdesc:a7ac046843eec05f06a1319ad775b1d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle and update LED game status when its timer expires.  <br /></td></tr>
<tr class="memitem:ad87634161bb46790ac2899cd466ea554" id="r_ad87634161bb46790ac2899cd466ea554"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad87634161bb46790ac2899cd466ea554">SystemState_LedGameStatusToggleTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:ad87634161bb46790ac2899cd466ea554"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback for LED game status toggle.  <br /></td></tr>
<tr class="memitem:ad8c30c9eb3b0089a3b91f25717f31ac0" id="r_ad8c30c9eb3b0089a3b91f25717f31ac0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8c30c9eb3b0089a3b91f25717f31ac0">SystemState_PeerSongCooldownTimerCallback</a> (TimerHandle_t xTimer)</td></tr>
<tr class="memdesc:ad8c30c9eb3b0089a3b91f25717f31ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">FreeRTOS timer callback to clear the peer song cooldown flag.  <br /></td></tr>
<tr class="memitem:a609ac1c229656b4e86ff0c7ab696b8cf" id="r_a609ac1c229656b4e86ff0c7ab696b8cf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a609ac1c229656b4e86ff0c7ab696b8cf">SystemState_TouchSensorNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a609ac1c229656b4e86ff0c7ab696b8cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle low-level touch sensor state change notifications.  <br /></td></tr>
<tr class="memitem:a70d159e5f362b681917de04a3b250434" id="r_a70d159e5f362b681917de04a3b250434"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70d159e5f362b681917de04a3b250434">SystemState_TouchActionNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a70d159e5f362b681917de04a3b250434"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle high-level touch action notifications.  <br /></td></tr>
<tr class="memitem:ae3eadb81cc93646134c0b5e36040736f" id="r_ae3eadb81cc93646134c0b5e36040736f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3eadb81cc93646134c0b5e36040736f">SystemState_BleNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:ae3eadb81cc93646134c0b5e36040736f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle BLE-related notifications impacting system state.  <br /></td></tr>
<tr class="memitem:a1b47bc93d1ffc9dfd5d5ed8ac7486b1c" id="r_a1b47bc93d1ffc9dfd5d5ed8ac7486b1c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b47bc93d1ffc9dfd5d5ed8ac7486b1c">SystemState_GameEventNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a1b47bc93d1ffc9dfd5d5ed8ac7486b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle notifications for interactive game lifecycle events.  <br /></td></tr>
<tr class="memitem:a6a3f4021b5f6edb8f29a511f6173347a" id="r_a6a3f4021b5f6edb8f29a511f6173347a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a3f4021b5f6edb8f29a511f6173347a">SystemState_NetworkTestNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a6a3f4021b5f6edb8f29a511f6173347a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle notifications conveying network test results.  <br /></td></tr>
<tr class="memitem:a11c1ea749eae11541f1beba8a978cbb1" id="r_a11c1ea749eae11541f1beba8a978cbb1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11c1ea749eae11541f1beba8a978cbb1">SystemState_SongNoteChangeNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a11c1ea749eae11541f1beba8a978cbb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle song playback and note change related notifications.  <br /></td></tr>
<tr class="memitem:a92b30a033cfad32162513fe495c5e5e0" id="r_a92b30a033cfad32162513fe495c5e5e0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92b30a033cfad32162513fe495c5e5e0">SystemState_PeerHeartbeatNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a92b30a033cfad32162513fe495c5e5e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle peer badge heartbeat notifications.  <br /></td></tr>
<tr class="memitem:a7cd38ec700d4680df1b7097d4f7b216b" id="r_a7cd38ec700d4680df1b7097d4f7b216b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cd38ec700d4680df1b7097d4f7b216b">SystemState_InteractiveGameNotificationHandler</a> (void *pObj, esp_event_base_t eventBase, int32_t notificationEvent, void *notificationData)</td></tr>
<tr class="memdesc:a7cd38ec700d4680df1b7097d4f7b216b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle interactive game state updates from BLE or other sources.  <br /></td></tr>
<tr class="memitem:a74a814194836f455978760143994bb9d" id="r_a74a814194836f455978760143994bb9d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74a814194836f455978760143994bb9d">SystemStateTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a74a814194836f455978760143994bb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Background task for lightweight periodic processing.  <br /></td></tr>
<tr class="memitem:ac078e14eed15817e1244ad735a89c978" id="r_ac078e14eed15817e1244ad735a89c978"><td class="memItemLeft" align="right" valign="top">SystemState *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac078e14eed15817e1244ad735a89c978">SystemState_GetInstance</a> (void)</td></tr>
<tr class="memdesc:ac078e14eed15817e1244ad735a89c978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the singleton <span class="tt">SystemState</span> instance.  <br /></td></tr>
<tr class="memitem:a262c65513ea756912b6184a63a6a9652" id="r_a262c65513ea756912b6184a63a6a9652"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a262c65513ea756912b6184a63a6a9652">SystemState_Init</a> (SystemState *this)</td></tr>
<tr class="memdesc:a262c65513ea756912b6184a63a6a9652"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the <span class="tt">SystemState</span> and all subsystems.  <br /></td></tr>
<tr class="memitem:a946e72b3f536b501d742d80aa713bf2a" id="r_a946e72b3f536b501d742d80aa713bf2a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a946e72b3f536b501d742d80aa713bf2a">SystemState_ProcessTouchModeEnabledModeCmd</a> (SystemState *this, TouchActionsCmd touchCmd)</td></tr>
<tr class="memdesc:a946e72b3f536b501d742d80aa713bf2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process touch mode enable commands.  <br /></td></tr>
<tr class="memitem:ad95f826bb7ca5ffae406a27755e40ef0" id="r_ad95f826bb7ca5ffae406a27755e40ef0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad95f826bb7ca5ffae406a27755e40ef0">SystemState_ProcessSynthModeCmd</a> (SystemState *this, TouchActionsCmd touchCmd)</td></tr>
<tr class="memdesc:ad95f826bb7ca5ffae406a27755e40ef0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process synth mode commands.  <br /></td></tr>
<tr class="memitem:abcf300b5bf37634bd10a2bf54959b3d2" id="r_abcf300b5bf37634bd10a2bf54959b3d2"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abcf300b5bf37634bd10a2bf54959b3d2">SystemState_ProcessMenuCmd</a> (SystemState *this, TouchActionsCmd touchCmd)</td></tr>
<tr class="memdesc:abcf300b5bf37634bd10a2bf54959b3d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process menu commands.  <br /></td></tr>
<tr class="memitem:ac917c51e1c7bb7f592a366ca66ec0e6a" id="r_ac917c51e1c7bb7f592a366ca66ec0e6a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac917c51e1c7bb7f592a366ca66ec0e6a">SystemState_ProcessTouchActionCmd</a> (SystemState *this, TouchActionsCmd touchCmd)</td></tr>
<tr class="memdesc:ac917c51e1c7bb7f592a366ca66ec0e6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a high-level touch action command.  <br /></td></tr>
<tr class="memitem:ab74b02c9ef8ca5485355a40f34bf9691" id="r_ab74b02c9ef8ca5485355a40f34bf9691"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab74b02c9ef8ca5485355a40f34bf9691">SystemState_ResetNetworkTestSuccessTimer</a> (SystemState *this)</td></tr>
<tr class="memdesc:ab74b02c9ef8ca5485355a40f34bf9691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arm/reset the success indication window after a network test.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a85b9c772bbeb480b209a3e6ea92b4c" id="r_a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a85b9c772bbeb480b209a3e6ea92b4c">TAG</a> = &quot;SYS&quot;</td></tr>
<tr class="memitem:a3b670c50c55c106d3ae53ec47e9fe26d" id="r_a3b670c50c55c106d3ae53ec47e9fe26d"><td class="memItemLeft" align="right" valign="top">static SystemState *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b670c50c55c106d3ae53ec47e9fe26d">pSystemState</a> = NULL</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Central system state management implementation for the Badge. </p>
<p>This module implements the primary state machine and coordination logic for the badge firmware. It owns and initializes all major subsystems (BLE, WiFi, touch, LEDs, audio, games), manages timers and transient state, and routes events between components via the NotificationDispatcher.</p>
<p>Key responsibilities:</p><ul>
<li>Initialize all subsystems and shared resources</li>
<li>Maintain global state flags and timers</li>
<li>Process touch commands and drive mode transitions</li>
<li>React to BLE, game, and network events</li>
<li>Coordinate LED modes and audio synthesis based on state</li>
</ul>
<p>Implementation notes:</p><ul>
<li>Runs a lightweight background task (<span class="tt">SystemStateTask</span>) used for periodic checks and to trigger network tests on-demand</li>
<li>Uses FreeRTOS timers for debounce/hold behaviors and UI durations</li>
<li>Integrates tightly with <span class="tt">LedModing</span>, <span class="tt">LedSequences</span>, <span class="tt">SynthMode</span>, <span class="tt">Ocarina</span>, <span class="tt">BleControl</span>, and <span class="tt">WifiClient</span></li>
</ul>
<p>Thread-safety:</p><ul>
<li>Most functions are called from the main app task or event callbacks</li>
<li>Timer callbacks should do minimal work and defer heavier operations via events when appropriate</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Badge Development Team </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024 </dd></dl>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="afb75e0fc85cbf5ae2caff4f92fced919" name="afb75e0fc85cbf5ae2caff4f92fced919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb75e0fc85cbf5ae2caff4f92fced919">&#9670;&#160;</a></span>BATTERY_SEQUENCE_DRAW_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BATTERY_SEQUENCE_DRAW_DURATION_MSEC&#160;&#160;&#160;(3000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1714a0043a0662cc25b9ad6b6b3a0cb9" name="a1714a0043a0662cc25b9ad6b6b3a0cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1714a0043a0662cc25b9ad6b6b3a0cb9">&#9670;&#160;</a></span>BLE_SERVICE_DISABLE_TIMEOUT_AFTER_GAME_INTERRUPTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BLE_SERVICE_DISABLE_TIMEOUT_AFTER_GAME_INTERRUPTION&#160;&#160;&#160;(10 * 1000 * 1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d81500c1609f5a48632c05e41012338" name="a2d81500c1609f5a48632c05e41012338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d81500c1609f5a48632c05e41012338">&#9670;&#160;</a></span>FIRSTBOOT_FILE_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FIRSTBOOT_FILE_NAME&#160;&#160;&#160;MOUNT_PATH &quot;/fb&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a83a6230f254c1690d772ddd1b3d1ecd3" name="a83a6230f254c1690d772ddd1b3d1ecd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a6230f254c1690d772ddd1b3d1ecd3">&#9670;&#160;</a></span>LED_GAME_STATUS_TOGGLE_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LED_GAME_STATUS_TOGGLE_DURATION_MSEC&#160;&#160;&#160;(5000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9d8e9ba4f6f26528547e10cf12b04757" name="a9d8e9ba4f6f26528547e10cf12b04757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8e9ba4f6f26528547e10cf12b04757">&#9670;&#160;</a></span>LED_PREVIEW_DRAW_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LED_PREVIEW_DRAW_DURATION_MSEC&#160;&#160;&#160;(2000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9beead3721c95a813057b4cf8b4cfa1" name="ac9beead3721c95a813057b4cf8b4cfa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9beead3721c95a813057b4cf8b4cfa1">&#9670;&#160;</a></span>NETWORK_TEST_DRAW_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NETWORK_TEST_DRAW_DURATION_MSEC&#160;&#160;&#160;(10000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aca300e35cbd8e1e85bc9a861d5b3abc4" name="aca300e35cbd8e1e85bc9a861d5b3abc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca300e35cbd8e1e85bc9a861d5b3abc4">&#9670;&#160;</a></span>NETWORK_TEST_SUCCESS_DRAW_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NETWORK_TEST_SUCCESS_DRAW_DURATION_MSEC&#160;&#160;&#160;(2000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0d585c6ccad4f1f84505749b0382fc11" name="a0d585c6ccad4f1f84505749b0382fc11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d585c6ccad4f1f84505749b0382fc11">&#9670;&#160;</a></span>PEER_RSSID_SONG_THRESHOLD_CREST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEER_RSSID_SONG_THRESHOLD_CREST&#160;&#160;&#160;(-58)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad562eb51a425b8b0c65343dc5459fa83" name="ad562eb51a425b8b0c65343dc5459fa83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad562eb51a425b8b0c65343dc5459fa83">&#9670;&#160;</a></span>PEER_RSSID_SONG_THRESHOLD_FMAN25</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEER_RSSID_SONG_THRESHOLD_FMAN25&#160;&#160;&#160;(-58)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d9718f519d6f273d9003f88eabf5ff3" name="a6d9718f519d6f273d9003f88eabf5ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9718f519d6f273d9003f88eabf5ff3">&#9670;&#160;</a></span>PEER_RSSID_SONG_THRESHOLD_REACTOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEER_RSSID_SONG_THRESHOLD_REACTOR&#160;&#160;&#160;(-50)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a69bf3d5117afe9362acf7c15daeaae9e" name="a69bf3d5117afe9362acf7c15daeaae9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69bf3d5117afe9362acf7c15daeaae9e">&#9670;&#160;</a></span>PEER_RSSID_SONG_THRESHOLD_TRON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEER_RSSID_SONG_THRESHOLD_TRON&#160;&#160;&#160;(-50)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a815f657876b0dfa8ee4485d7d94fb1a7" name="a815f657876b0dfa8ee4485d7d94fb1a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a815f657876b0dfa8ee4485d7d94fb1a7">&#9670;&#160;</a></span>PEER_SONG_COOLDOWN_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PEER_SONG_COOLDOWN_DURATION_MSEC&#160;&#160;&#160;(3*60*1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ae9983b8b8d110990dac19c6432077b" name="a3ae9983b8b8d110990dac19c6432077b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae9983b8b8d110990dac19c6432077b">&#9670;&#160;</a></span>STATUS_INDICATOR_DRAW_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATUS_INDICATOR_DRAW_DURATION_MSEC&#160;&#160;&#160;(3000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7df2e96e10499c689d17b995e333a4b" name="ad7df2e96e10499c689d17b995e333a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7df2e96e10499c689d17b995e333a4b">&#9670;&#160;</a></span>TOUCH_ACTIVE_TIMEOUT_DURATION_MSEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOUCH_ACTIVE_TIMEOUT_DURATION_MSEC&#160;&#160;&#160;(5000)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ae06cab80adb3f870e90cc3f751d85928" name="ae06cab80adb3f870e90cc3f751d85928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06cab80adb3f870e90cc3f751d85928">&#9670;&#160;</a></span>SystemState_BatteryIndicatorActiveTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_BatteryIndicatorActiveTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback for battery indicator active window expiry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2bd564264ee656fea9d997c1dc1bb2ef" name="a2bd564264ee656fea9d997c1dc1bb2ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd564264ee656fea9d997c1dc1bb2ef">&#9670;&#160;</a></span>SystemState_BatteryIndicatorInactiveTimerExpired()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_BatteryIndicatorInactiveTimerExpired </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Turn off the battery indicator when its active window expires. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success. </dd></dl>

</div>
</div>
<a id="ae3eadb81cc93646134c0b5e36040736f" name="ae3eadb81cc93646134c0b5e36040736f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3eadb81cc93646134c0b5e36040736f">&#9670;&#160;</a></span>SystemState_BleNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_BleNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle BLE-related notifications impacting system state. </p>
<p>Responds to BLE connection state changes, OTA events, and interactive game exchanges by updating LED modes, toggling reconnection indicators, and coordinating with other subsystems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to owning <span class="tt">SystemState</span>. </td></tr>
    <tr><td class="paramname">eventBase</td><td>BLE event base. </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Notification/event ID. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Optional payload depending on event type. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1b47bc93d1ffc9dfd5d5ed8ac7486b1c" name="a1b47bc93d1ffc9dfd5d5ed8ac7486b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b47bc93d1ffc9dfd5d5ed8ac7486b1c">&#9670;&#160;</a></span>SystemState_GameEventNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_GameEventNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle notifications for interactive game lifecycle events. </p>
<p>Responds to event start/join and end notifications by updating LED modes, scheduling heartbeats, and synchronizing the current event ID with BLE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base for game events. </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Specific game event type. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Optional payload (e.g., event id string). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac078e14eed15817e1244ad735a89c978" name="ac078e14eed15817e1244ad735a89c978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac078e14eed15817e1244ad735a89c978">&#9670;&#160;</a></span>SystemState_GetInstance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SystemState * SystemState_GetInstance </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the singleton <span class="tt">SystemState</span> instance. </p>
<p>Lazily allocates the global <span class="tt">SystemState</span> storage the first time it is requested. The structure contents are initialized by <span class="tt"><a class="el" href="#a262c65513ea756912b6184a63a6a9652" title="Initialize the SystemState and all subsystems.">SystemState_Init()</a></span>.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the global <span class="tt">SystemState</span> object (never NULL after first allocation). </dd></dl>

</div>
</div>
<a id="a262c65513ea756912b6184a63a6a9652" name="a262c65513ea756912b6184a63a6a9652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a262c65513ea756912b6184a63a6a9652">&#9670;&#160;</a></span>SystemState_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_Init </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the <span class="tt">SystemState</span> and all subsystems. </p>
<p>Creates timers, initializes persistent storage and the virtual filesystem, sets up subsystem instances (console, notifications, sensors, LEDs, BLE, WiFi, audio, game client), and configures badge-type dependent features.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to the <span class="tt">SystemState</span> to initialize. Must not be NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success; suitable ESP-IDF error code on failure. </dd></dl>

</div>
</div>
<a id="a7cd38ec700d4680df1b7097d4f7b216b" name="a7cd38ec700d4680df1b7097d4f7b216b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd38ec700d4680df1b7097d4f7b216b">&#9670;&#160;</a></span>SystemState_InteractiveGameNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_InteractiveGameNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle interactive game state updates from BLE or other sources. </p>
<p>Enables/disables interactive game LED mode and audio feedback based on the active bit in the provided mapping payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (interactive game domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Event ID. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to InteractiveGameData payload. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad87634161bb46790ac2899cd466ea554" name="ad87634161bb46790ac2899cd466ea554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad87634161bb46790ac2899cd466ea554">&#9670;&#160;</a></span>SystemState_LedGameStatusToggleTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_LedGameStatusToggleTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback for LED game status toggle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7ac046843eec05f06a1319ad775b1d52" name="a7ac046843eec05f06a1319ad775b1d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ac046843eec05f06a1319ad775b1d52">&#9670;&#160;</a></span>SystemState_LedGameStatusToggleTimerExpired()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_LedGameStatusToggleTimerExpired </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Toggle and update LED game status when its timer expires. </p>
<p>Flips the internal flag, re-arms the timer, and updates LED mode state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success; error otherwise. </dd></dl>

</div>
</div>
<a id="ac9a8d9f0757ff17e015bdc321daa9552" name="ac9a8d9f0757ff17e015bdc321daa9552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a8d9f0757ff17e015bdc321daa9552">&#9670;&#160;</a></span>SystemState_LedSequencePreviewActiveTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_LedSequencePreviewActiveTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback for LED sequence preview expiry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a03c8feae48b305bfaeac538c8231b7d2" name="a03c8feae48b305bfaeac538c8231b7d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c8feae48b305bfaeac538c8231b7d2">&#9670;&#160;</a></span>SystemState_LedSequencePreviewInactiveTimerExpired()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_LedSequencePreviewInactiveTimerExpired </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop the LED sequence preview when its timer expires. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success. </dd></dl>

</div>
</div>
<a id="a5d5118df61ee04a31af3cfb07fe74d32" name="a5d5118df61ee04a31af3cfb07fe74d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d5118df61ee04a31af3cfb07fe74d32">&#9670;&#160;</a></span>SystemState_NetworkTestActiveTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_NetworkTestActiveTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback for network test active window expiry. </p>
<p>Retrieves the singleton and performs network test shutdown and touch timer stop to avoid UI overlap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5283ee515f6c93e4fc358a5370b7d491" name="a5283ee515f6c93e4fc358a5370b7d491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5283ee515f6c93e4fc358a5370b7d491">&#9670;&#160;</a></span>SystemState_NetworkTestInactiveTimerExpired()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_NetworkTestInactiveTimerExpired </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timer expiry callback body for network test activity window. </p>
<p>Marks the network test as inactive and disables the corresponding LED mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, error otherwise. </dd></dl>

</div>
</div>
<a id="a6a3f4021b5f6edb8f29a511f6173347a" name="a6a3f4021b5f6edb8f29a511f6173347a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3f4021b5f6edb8f29a511f6173347a">&#9670;&#160;</a></span>SystemState_NetworkTestNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_NetworkTestNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle notifications conveying network test results. </p>
<p>Caches the success flag, stops the active window, and triggers the success indication timer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (network test domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Event ID (unused). </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to bool success flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a92b30a033cfad32162513fe495c5e5e0" name="a92b30a033cfad32162513fe495c5e5e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b30a033cfad32162513fe495c5e5e0">&#9670;&#160;</a></span>SystemState_PeerHeartbeatNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_PeerHeartbeatNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle peer badge heartbeat notifications. </p>
<p>Plays a badge-type specific song when a nearby peer is detected above a configured RSSI threshold, with cooldown and de-duplication to avoid spam.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (BLE peer domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Event ID. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to PeerReport payload. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad8c30c9eb3b0089a3b91f25717f31ac0" name="ad8c30c9eb3b0089a3b91f25717f31ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8c30c9eb3b0089a3b91f25717f31ac0">&#9670;&#160;</a></span>SystemState_PeerSongCooldownTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_PeerSongCooldownTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback to clear the peer song cooldown flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abcf300b5bf37634bd10a2bf54959b3d2" name="abcf300b5bf37634bd10a2bf54959b3d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf300b5bf37634bd10a2bf54959b3d2">&#9670;&#160;</a></span>SystemState_ProcessMenuCmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SystemState_ProcessMenuCmd </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TouchActionsCmd</td>          <td class="paramname"><span class="paramname"><em>touchCmd</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process menu commands. </p>
<p>Handles LED sequence selection, BLE pairing toggles, voltage meter, and touch enable/disable requests. Updates LED preview timers and statistics counters where appropriate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">touchCmd</td><td>Menu command to process. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the command was handled; false otherwise. </dd></dl>

</div>
</div>
<a id="ad95f826bb7ca5ffae406a27755e40ef0" name="ad95f826bb7ca5ffae406a27755e40ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad95f826bb7ca5ffae406a27755e40ef0">&#9670;&#160;</a></span>SystemState_ProcessSynthModeCmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SystemState_ProcessSynthModeCmd </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TouchActionsCmd</td>          <td class="paramname"><span class="paramname"><em>touchCmd</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process synth mode commands. </p>
<p>Manages enabling/disabling of touch-driven audio synthesis and Ocarina when the buzzer/audio hardware is present.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">touchCmd</td><td>Synth-related command to process. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the command was handled; false otherwise. </dd></dl>

</div>
</div>
<a id="ac917c51e1c7bb7f592a366ca66ec0e6a" name="ac917c51e1c7bb7f592a366ca66ec0e6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac917c51e1c7bb7f592a366ca66ec0e6a">&#9670;&#160;</a></span>SystemState_ProcessTouchActionCmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_ProcessTouchActionCmd </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TouchActionsCmd</td>          <td class="paramname"><span class="paramname"><em>touchCmd</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process a high-level touch action command. </p>
<p>Applies guard conditions (clear-required, interactive game interlocks) and routes the command to one of three handlers based on current state:</p><ul>
<li>Touch mode enable/disable</li>
<li>Synth mode controls</li>
<li>Menu navigation and actions</li>
</ul>
<p>Increments badge statistics when a command is processed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to <span class="tt">SystemState</span>. </td></tr>
    <tr><td class="paramname">touchCmd</td><td>Enumerated touch action command to handle. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a946e72b3f536b501d742d80aa713bf2a" name="a946e72b3f536b501d742d80aa713bf2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946e72b3f536b501d742d80aa713bf2a">&#9670;&#160;</a></span>SystemState_ProcessTouchModeEnabledModeCmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SystemState_ProcessTouchModeEnabledModeCmd </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TouchActionsCmd</td>          <td class="paramname"><span class="paramname"><em>touchCmd</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process touch mode enable commands. </p>
<p>Handles the enable touch command and transitions the system into an active touch state, notifies interested subsystems, and arms the touch activity timer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">touchCmd</td><td>Touch command to evaluate in this mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the command was handled; false otherwise. </dd></dl>

</div>
</div>
<a id="a577a928c99dd0537ef3adeeee8f93702" name="a577a928c99dd0537ef3adeeee8f93702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a577a928c99dd0537ef3adeeee8f93702">&#9670;&#160;</a></span>SystemState_ResetBatteryIndicatorActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetBatteryIndicatorActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Arm/reset the battery indicator active timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was reset; error otherwise. </dd></dl>

</div>
</div>
<a id="adf227eb58095d9e7db0d0558a56bcb56" name="adf227eb58095d9e7db0d0558a56bcb56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf227eb58095d9e7db0d0558a56bcb56">&#9670;&#160;</a></span>SystemState_ResetLedSequencePreviewActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetLedSequencePreviewActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Arm/reset the LED sequence preview timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was reset; error otherwise. </dd></dl>

</div>
</div>
<a id="a6f69ef3e19b1c56056c0d0d0c2477211" name="a6f69ef3e19b1c56056c0d0d0c2477211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f69ef3e19b1c56056c0d0d0c2477211">&#9670;&#160;</a></span>SystemState_ResetNetworkTestActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetNetworkTestActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Arm/reset the network test active timer and set active flag. </p>
<p>Used to bound the duration for which the network test UI remains active.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was reset; error otherwise. </dd></dl>

</div>
</div>
<a id="ab74b02c9ef8ca5485355a40f34bf9691" name="ab74b02c9ef8ca5485355a40f34bf9691"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab74b02c9ef8ca5485355a40f34bf9691">&#9670;&#160;</a></span>SystemState_ResetNetworkTestSuccessTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetNetworkTestSuccessTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Arm/reset the success indication window after a network test. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was reset; error otherwise. </dd></dl>

</div>
</div>
<a id="afbed9dd56bb381a1dca666e4503d0880" name="afbed9dd56bb381a1dca666e4503d0880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbed9dd56bb381a1dca666e4503d0880">&#9670;&#160;</a></span>SystemState_ResetPeerSongCooldownTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetPeerSongCooldownTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset the cooldown timer that gates peer song replays. </p>
<p>Prevents immediate re-triggering of peer songs after one has just played.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was reset; error otherwise. </dd></dl>

</div>
</div>
<a id="abfedaea5a33eb8d26d6ea8f9bd8a6404" name="abfedaea5a33eb8d26d6ea8f9bd8a6404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfedaea5a33eb8d26d6ea8f9bd8a6404">&#9670;&#160;</a></span>SystemState_ResetTouchActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_ResetTouchActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset/arm the touch activity timer. </p>
<p>Keeps touch mode active while touch interactions continue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was successfully reset. </dd></dl>

</div>
</div>
<a id="a11c1ea749eae11541f1beba8a978cbb1" name="a11c1ea749eae11541f1beba8a978cbb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c1ea749eae11541f1beba8a978cbb1">&#9670;&#160;</a></span>SystemState_SongNoteChangeNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_SongNoteChangeNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle song playback and note change related notifications. </p>
<p>Updates LED status for song activity and manages first boot and peer song cooldown behaviors based on the song event details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to SystemState. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (song domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Event ID. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to SongNoteChangeEventNotificationData. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a559a16a968af7d423b8a52d1f55e632e" name="a559a16a968af7d423b8a52d1f55e632e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559a16a968af7d423b8a52d1f55e632e">&#9670;&#160;</a></span>SystemState_StopNetworkTestActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_StopNetworkTestActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop the network test active timer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if the timer was stopped; error otherwise. </dd></dl>

</div>
</div>
<a id="a9285f807d167d4cab0c5caca796b2b7d" name="a9285f807d167d4cab0c5caca796b2b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9285f807d167d4cab0c5caca796b2b7d">&#9670;&#160;</a></span>SystemState_StopTouchActiveTimer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_StopTouchActiveTimer </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop the touch activity timer and transition to inactive state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK after executing the inactive transition logic. </dd></dl>

</div>
</div>
<a id="a70d159e5f362b681917de04a3b250434" name="a70d159e5f362b681917de04a3b250434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d159e5f362b681917de04a3b250434">&#9670;&#160;</a></span>SystemState_TouchActionNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_TouchActionNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle high-level touch action notifications. </p>
<p>Extracts the <span class="tt">TouchActionsCmd</span> from the payload and forwards it to <span class="tt"><a class="el" href="#ac917c51e1c7bb7f592a366ca66ec0e6a" title="Process a high-level touch action command.">SystemState_ProcessTouchActionCmd()</a></span>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to owning <span class="tt">SystemState</span>. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (unused, touch actions domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Notification ID (unused). </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to <span class="tt">TouchActionsCmd</span> value. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab31a5c038c7b0e33a74c95e81ea446cc" name="ab31a5c038c7b0e33a74c95e81ea446cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab31a5c038c7b0e33a74c95e81ea446cc">&#9670;&#160;</a></span>SystemState_TouchActiveTimerCallback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_TouchActiveTimerCallback </td>
          <td>(</td>
          <td class="paramtype">TimerHandle_t</td>          <td class="paramname"><span class="paramname"><em>xTimer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>FreeRTOS timer callback for touch activity timeout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xTimer</td><td>FreeRTOS timer handle (unused). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a00d3c2470bb1fdb78771896e764843b8" name="a00d3c2470bb1fdb78771896e764843b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d3c2470bb1fdb78771896e764843b8">&#9670;&#160;</a></span>SystemState_TouchInactiveTimerExpired()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemState_TouchInactiveTimerExpired </td>
          <td>(</td>
          <td class="paramtype">SystemState *</td>          <td class="paramname"><span class="paramname"><em>this</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deactivate touch mode when the touch inactivity timer expires. </p>
<p>Disables touch sensors, updates LED/audible status, and notifies listeners.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">this</td><td>Pointer to SystemState. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK if notification dispatch was successful. </dd></dl>

</div>
</div>
<a id="a609ac1c229656b4e86ff0c7ab696b8cf" name="a609ac1c229656b4e86ff0c7ab696b8cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609ac1c229656b4e86ff0c7ab696b8cf">&#9670;&#160;</a></span>SystemState_TouchSensorNotificationHandler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemState_TouchSensorNotificationHandler </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pObj</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_event_base_t</td>          <td class="paramname"><span class="paramname"><em>eventBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>notificationEvent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>notificationData</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle low-level touch sensor state change notifications. </p>
<p>Updates BLE and LED subsystems with per-sensor activity, increments touch counters, and refreshes the touch activity timeout when touch remains active.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pObj</td><td>Pointer to owning <span class="tt">SystemState</span> instance. </td></tr>
    <tr><td class="paramname">eventBase</td><td>Event base (unused, touch sensor domain). </td></tr>
    <tr><td class="paramname">notificationEvent</td><td>Specific touch sensor event ID. </td></tr>
    <tr><td class="paramname">notificationData</td><td>Pointer to <span class="tt">TouchSensorEventNotificationData</span> payload. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74a814194836f455978760143994bb9d" name="a74a814194836f455978760143994bb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a814194836f455978760143994bb9d">&#9670;&#160;</a></span>SystemStateTask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SystemStateTask </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>pvParameters</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Background task for lightweight periodic processing. </p>
<p>Monitors the <span class="tt">networkTestActive</span> flag and triggers WiFi connectivity test requests when the value changes to true. Sleeps between checks to avoid unnecessary CPU usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvParameters</td><td>Pointer to the owning <span class="tt">SystemState</span> instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a3b670c50c55c106d3ae53ec47e9fe26d" name="a3b670c50c55c106d3ae53ec47e9fe26d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b670c50c55c106d3ae53ec47e9fe26d">&#9670;&#160;</a></span>pSystemState</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SystemState* pSystemState = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5a85b9c772bbeb480b209a3e6ea92b4c" name="a5a85b9c772bbeb480b209a3e6ea92b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a85b9c772bbeb480b209a3e6ea92b4c">&#9670;&#160;</a></span>TAG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* TAG = &quot;SYS&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="_system_state_8c.html">SystemState.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
